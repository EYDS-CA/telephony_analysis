<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CX Insights Dashboard</title>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@2.26.0/plotly.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=EYInterstate:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Custom Styles -->
    <style>
      /* EY Brand Colors */
      :root {
        --ey-yellow: #ffe600;
        --ey-black: #2e2e38;
        --ey-gray-dark: #747480;
        --ey-gray-medium: #c4c4cd;
        --ey-gray-light: #f2f2f2;
        --ey-white: #ffffff;
        --ey-blue: #00a3e0;
        --ey-green: #00a88e;
        --ey-red: #ee3124;
        --ey-purple: #7e3f98;
        --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);

        /* Rogers Brand Colors */
        --rogers-red: #e20a16;
        --rogers-red-dark: #c40914;
        --rogers-red-light: #ff4550;
        --rogers-black: #000000;
        --rogers-gray: #6c757d;
        --rogers-blue: #004a9f;

        /* Bell Brand Colors */
        --bell-blue: #0066cc;
        --bell-blue-dark: #004499;
        --bell-blue-light: #3388ff;
        --bell-gray: #545454;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", "EYInterstate", -apple-system, sans-serif;
        background: var(--ey-gray-light);
        color: var(--ey-black);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
      }

      /* Professional Header */
      .header {
        background: var(--ey-white);
        border-bottom: 1px solid var(--ey-gray-medium);
        padding: 0;
        box-shadow: var(--shadow-sm);
      }

      .header-top {
        background: var(--ey-black);
        color: var(--ey-white);
        padding: 1rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .ey-logo {
        font-size: 2rem;
        font-weight: 700;
        letter-spacing: -0.05em;
      }

      .header-meta {
        font-size: 0.875rem;
        opacity: 0.8;
      }

      .header-main {
        padding: 2rem;
        background: var(--ey-white);
        text-align: center;
      }

      .header-title {
        font-size: 2.5rem;
        font-weight: 300;
        color: var(--ey-black);
        margin-bottom: 0.5rem;
        letter-spacing: -0.02em;
      }

      .header-subtitle {
        font-size: 1.125rem;
        color: var(--ey-gray-dark);
        margin-bottom: 2rem;
      }

      /* Key Metrics Bar */
      .metrics-bar {
        display: flex;
        gap: 2rem;
        padding: 1.5rem 0;
        border-top: 1px solid var(--ey-gray-light);
        flex-wrap: wrap;
        justify-content: center;
        max-width: 800px;
        margin: 0 auto;
      }

      .metric-item {
        flex: 1;
        min-width: 150px;
      }

      .metric-value {
        font-size: 2rem;
        font-weight: 600;
        color: var(--ey-black);
        line-height: 1.2;
      }

      .metric-label {
        font-size: 0.875rem;
        color: var(--ey-gray-dark);
        margin-top: 0.25rem;
      }

      .metric-trend {
        font-size: 0.75rem;
        margin-top: 0.25rem;
        font-weight: 500;
      }

      .metric-trend.positive {
        color: var(--ey-green);
      }
      .metric-trend.negative {
        color: var(--ey-red);
      }

      /* Navigation */
      .nav-container {
        background: var(--ey-white);
        border-bottom: 1px solid var(--ey-gray-medium);
        padding: 0 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: var(--shadow-sm);
      }

      .nav-tabs {
        display: flex;
        gap: 2rem;
        margin: 0 auto;
        justify-content: center;
      }

      .nav-tab {
        padding: 1.25rem 0;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        color: var(--ey-gray-dark);
        position: relative;
        transition: color 0.2s;
      }

      .nav-tab:hover {
        color: var(--ey-black);
      }

      .nav-tab.active {
        color: var(--ey-black);
        font-weight: 600;
      }

      .nav-tab.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--ey-yellow);
      }

      /* Main Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Professional Cards */
      .card {
        background: var(--ey-white);
        border-radius: 8px;
        padding: 2rem;
        box-shadow: var(--shadow-md);
        margin-bottom: 2rem;
      }

      .card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--ey-gray-light);
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--ey-black);
        margin: 0;
      }

      .card-subtitle {
        font-size: 0.875rem;
        color: var(--ey-gray-dark);
        margin-top: 0.25rem;
      }

      /* Filter Section */
      .filters-section {
        background: var(--ey-white);
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-sm);
      }

      .filters-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
      }

      .filters-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--ey-black);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }

      .filter-group {
        display: flex;
        flex-direction: column;
      }

      .filter-label {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--ey-gray-dark);
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .filter-input {
        padding: 0.75rem 1rem;
        border: 1px solid var(--ey-gray-medium);
        border-radius: 4px;
        font-size: 0.875rem;
        transition: all 0.2s;
        background: var(--ey-white);
      }

      .filter-input:focus {
        outline: none;
        border-color: var(--ey-blue);
        box-shadow: 0 0 0 2px rgba(0, 163, 224, 0.1);
      }

      /* Grid System */
      .grid {
        display: grid;
        gap: 2rem;
      }

      .grid-2 {
        grid-template-columns: repeat(2, 1fr);
      }

      @media (max-width: 968px) {
        .grid-2 {
          grid-template-columns: 1fr;
        }
      }

      /* Charts */
      .chart-container {
        min-height: 350px;
        position: relative;
        padding: 0;
      }

      /* Executive Summary */
      .executive-summary {
        background: linear-gradient(
          135deg,
          var(--ey-gray-light) 0%,
          var(--ey-white) 100%
        );
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
      }

      .insight-box {
        background: var(--ey-white);
        border-left: 4px solid var(--ey-yellow);
        padding: 1.5rem;
        margin-bottom: 1rem;
        border-radius: 4px;
        box-shadow: var(--shadow-sm);
      }

      .insight-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--ey-black);
        margin-bottom: 0.5rem;
      }

      .insight-content {
        font-size: 0.875rem;
        color: var(--ey-gray-dark);
        line-height: 1.6;
      }

      .highlight-metric {
        font-weight: 600;
        color: var(--ey-blue);
      }

      /* Report Section */
      .report-section {
        background: var(--ey-white);
        border-radius: 8px;
        padding: 3rem;
        box-shadow: var(--shadow-lg);
        margin-top: 2rem;
      }

      .report-header {
        text-align: center;
        margin-bottom: 3rem;
        padding-bottom: 2rem;
        border-bottom: 2px solid var(--ey-gray-light);
      }

      .report-title {
        font-size: 2rem;
        font-weight: 300;
        color: var(--ey-black);
        margin-bottom: 0.5rem;
      }

      .report-subtitle {
        font-size: 1.125rem;
        color: var(--ey-gray-dark);
      }

      .report-content {
        max-width: 900px;
        margin: 0 auto;
        line-height: 1.8;
        color: var(--ey-black);
      }

      .report-content h2 {
        font-size: 1.5rem;
        font-weight: 600;
        margin: 2.5rem 0 1rem;
        color: var(--ey-black);
      }

      .report-content h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin: 2rem 0 1rem;
        color: var(--ey-black);
      }

      .report-content p {
        margin-bottom: 1rem;
        font-size: 1rem;
      }

      .report-content ul {
        margin: 1rem 0 1rem 2rem;
      }

      .report-content ol {
        margin: 1rem 0 1rem 0;
        padding-left: 1.5rem;
      }

      .report-content li {
        margin-bottom: 0.5rem;
      }

      /* Tab Content */
      .tab-content {
        display: none;
        animation: fadeIn 0.3s ease-in-out;
      }

      .tab-content.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Data Table */
      .data-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.875rem;
      }

      .data-table th {
        background: var(--ey-gray-light);
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: var(--ey-black);
        border-bottom: 2px solid var(--ey-gray-medium);
      }

      .data-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--ey-gray-light);
      }

      .data-table tr:hover {
        background: var(--ey-gray-light);
      }

      /* Sentiment Badge */
      .sentiment-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .sentiment-positive {
        background: rgba(0, 168, 142, 0.1);
        color: var(--ey-green);
      }

      .sentiment-negative {
        background: rgba(238, 49, 36, 0.1);
        color: var(--ey-red);
      }

      .sentiment-neutral {
        background: rgba(196, 196, 205, 0.2);
        color: var(--ey-gray-dark);
      }

      /* Loading State */
      .loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 60vh;
      }

      .loading-spinner {
        width: 48px;
        height: 48px;
        border: 3px solid var(--ey-gray-light);
        border-radius: 50%;
        border-top-color: var(--ey-yellow);
        animation: spin 1s linear infinite;
        margin-bottom: 1.5rem;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Responsive */
      @media (max-width: 768px) {
        .header-title {
          font-size: 2rem;
        }

        .metrics-bar {
          gap: 1rem;
        }

        .metric-item {
          min-width: 120px;
        }

        .container {
          padding: 1rem;
        }

        .nav-tabs {
          gap: 1rem;
          font-size: 0.875rem;
        }
      }

      /* iOS-style Segmented Control */
      .segmented-control {
        display: flex;
        background: var(--ey-gray-light);
        border-radius: 8px;
        padding: 2px;
        margin: 1rem 0;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .segmented-option {
        flex: 1;
        padding: 8px 16px;
        background: transparent;
        border: none;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--ey-gray-dark);
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: center;
      }

      .segmented-option.active {
        background: var(--ey-white);
        color: var(--ey-black);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        font-weight: 600;
      }

      .segmented-option:hover:not(.active) {
        color: var(--ey-black);
      }

      /* Print Styles */
      @media print {
        .filters-section,
        .nav-container,
        .segmented-control {
          display: none;
        }

        .card {
          break-inside: avoid;
          box-shadow: none;
          border: 1px solid var(--ey-gray-medium);
        }
      }

      /* Rogers Brand Styling */
      .rogers-branded {
        border-left: 4px solid var(--rogers-red);
        position: relative;
      }

      .rogers-branded::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--rogers-red) 0%,
          var(--rogers-red-light) 100%
        );
      }

      .rogers-branded .card-title {
        color: var(--rogers-red-dark);
      }

      .rogers-branded .highlight-metric {
        color: var(--rogers-red);
        background: rgba(226, 10, 22, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: 600;
      }

      /* Enhanced styling for Rogers when selected */
      .card.rogers-selected {
        border: 2px solid var(--rogers-red);
        box-shadow: 0 8px 24px rgba(226, 10, 22, 0.15);
        transform: translateY(-2px);
        transition: all 0.3s ease;
      }

      .card.bell-selected {
        border: 2px solid var(--bell-blue);
        box-shadow: 0 8px 24px rgba(0, 102, 204, 0.15);
        transform: translateY(-2px);
        transition: all 0.3s ease;
      }

      /* Segmented control Rogers styling */
      .segmented-option[data-value="rogers"].active {
        background: var(--rogers-red);
        color: var(--ey-white);
      }

      .segmented-option[data-value="bell"].active {
        background: var(--bell-blue);
        color: var(--ey-white);
      }

      /* Bell Brand Styling (matching Rogers structure) */
      .bell-branded {
        border-left: 4px solid var(--bell-blue);
        position: relative;
      }

      .bell-branded::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--bell-blue) 0%,
          var(--bell-blue-light) 100%
        );
      }

      .bell-branded .card-title {
        color: var(--bell-blue-dark);
      }

      .bell-branded .highlight-metric {
        color: var(--bell-blue);
        background: rgba(0, 102, 204, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: 600;
      }

      /* Rogers Brand Styling */
      .rogers-branded {
        border-left: 4px solid var(--rogers-red);
        position: relative;
      }

      .rogers-branded::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--rogers-red),
          var(--rogers-red-light)
        );
      }

      .rogers-branded .card-title {
        color: var(--rogers-red-dark);
      }

      .rogers-branded .highlight-metric {
        color: var(--rogers-red);
        background: rgba(226, 10, 22, 0.1);
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: 600;
      }

      .rogers-selected {
        box-shadow: 0 4px 12px rgba(226, 10, 22, 0.15);
        transform: translateY(-1px);
        transition: all 0.3s ease;
      }

      .rogers-highlight {
        background: rgba(226, 10, 22, 0.05) !important;
        border-left: 3px solid var(--rogers-red) !important;
        border-radius: 4px;
        animation: rogersPulse 2s ease-in-out infinite;
      }

      @keyframes rogersPulse {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(226, 10, 22, 0.1);
        }
        50% {
          box-shadow: 0 0 0 8px rgba(226, 10, 22, 0.05);
        }
      }

      .rogers-button {
        background: var(--rogers-red) !important;
        color: white !important;
        transition: all 0.3s ease;
      }

      .rogers-button:hover {
        background: var(--rogers-red-dark) !important;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(226, 10, 22, 0.3);
      }
    </style>
  </head>

  <body>
    <!-- Professional Header -->
    <header class="header">
      <div class="header-top">
        <div class="ey-logo"></div>
        <div class="header-meta">Digital & Emerging Technologies</div>
      </div>
      <div class="header-main">
        <h1 class="header-title">Customer Experience Analytics</h1>
        <p class="header-subtitle">
          Comprehensive analysis of Rogers and Bell mobile application feedback
        </p>
        <p
          style="
            font-size: 0.875rem;
            color: var(--ey-gray-dark);
            margin-top: 0.5rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
          "
        >
          <strong>Research Methodology:</strong> We extracted 30,000+ reviews
          across Android and iOS app stores, then individually analyzed 10,103
          current reviews (2020-2025) using Anthropic's Claude API to categorize
          and tag key issues. Rogers: 7,055 reviews, Bell: 3,048 reviews. 99.6%
          data currency with 15,913 CCTS complaints cross-validation from all
          telecom providers to identify critical failure points.
        </p>

        <div class="metrics-bar">
          <div class="metric-item">
            <div class="metric-value" id="totalReviews">10,103</div>
            <div class="metric-label">Reviews Analyzed</div>
          </div>
          <div class="metric-item">
            <div class="metric-value" id="avgRating">2.58</div>
            <div class="metric-label">Average Rating</div>
            <div class="metric-trend negative">vs 4.4 App Store</div>
          </div>
          <div class="metric-item">
            <div class="metric-value" id="cctsComplaints">15,913</div>
            <div class="metric-label">CCTS Complaints</div>
            <div class="metric-trend negative">6-Month Period</div>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-container">
      <div class="nav-tabs" style="max-width: 1400px; margin: 0 auto">
        <button
          class="nav-tab active"
          onclick="event.stopPropagation(); showTab('insights')"
        >
          Executive Insights
        </button>
        <button
          class="nav-tab"
          onclick="event.stopPropagation(); showTab('analysis')"
        >
          Reviews
        </button>
        <button
          class="nav-tab"
          onclick="event.stopPropagation(); showTab('report')"
        >
          Strategic Report
        </button>
        <button
          class="nav-tab"
          onclick="event.stopPropagation(); showTab('methodology')"
        >
          Research Methodology
        </button>
        <button
          class="nav-tab"
          onclick="event.stopPropagation(); showTab('reports')"
        >
          All Reports
        </button>
      </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
      <!-- Loading State -->
      <div id="loading" class="loading">
        <div class="loading-spinner"></div>
        <h3>Loading Analytics Dashboard...</h3>
        <p>
          Preparing insights from 10,103 current customer reviews (2020-2025)
        </p>
      </div>

      <!-- Dashboard Content -->
      <div id="dashboard" style="display: none">
        <!-- Executive Insights Tab -->
        <div id="insights" class="tab-content active">
          <!-- Executive Summary -->
          <div class="executive-summary">
            <h2 style="margin-bottom: 1.5rem">Executive Summary</h2>

            <div class="insight-box">
              <div class="insight-title">
                The Telecom App Hierarchy of Needs
              </div>
              <div class="insight-content">
                Cross-analysis of 10,103 app reviews and 15,913 CCTS complaints reveals a hierarchy that predicts regulatory escalation:<br /><br />
                <span class="highlight-metric">Level 1: Core Function Reliability (26.8%)</span> -
                Authentication (719 reviews), crashes (501), technical issues (670), and performance (815). CCTS data shows 23.3% cite service delivery failures - proving app problems escalate to regulatory complaints.<br /><br />
                <span class="highlight-metric">Level 2: Human Support Access (8.1%)</span> -
                Only after basic functions work do customers value responsive service (814 reviews). Our refinement revealed 67.5% of "support" complaints are actually preventable system failures.<br /><br />
                <span class="highlight-metric">Level 3: Performance (10.0%)</span> -
                Network issues (181), coverage problems (150), speed complaints (815). These predict churn before contract violations.<br /><br />
                <span class="highlight-metric">Level 4: User Experience (7.9%)</span> -
                Design and features matter only when foundation is solid (797 UX reviews vs 1,735 positive reviews).<br /><br />
                <span class="highlight-metric">Critical Finding:</span> 42.4% of CCTS complaints are billing-related, yet only 4.0% of app reviews cite billing issues - proving many customers escalate directly to regulators when apps fail core payment functions.
              </div>
            </div>

            <div class="insight-box">
              <div class="insight-title">Platform Performance Gap</div>
              <div class="insight-content">
                Rogers users experience significantly worse technical
                performance than Bell users across critical functions:<br /><br />
                <span class="highlight-metric"
                  >Authentication failures 6x higher</span
                >
                for Rogers (616 vs 103 reviews), blocking basic app access.<br /><br />
                <span class="highlight-metric"
                  >App crashes 4.8x more frequent</span
                >
                for Rogers (414 vs 87 reviews), creating reliability perception
                problems.<br /><br />
                <span class="highlight-metric"
                  >Performance complaints 4.7x higher</span
                >
                for Rogers (671 vs 144 reviews), indicating systemic platform
                instability.<br /><br />
                This suggests Rogers faces critical technical debt requiring
                immediate platform stabilization investment, while Bell should
                focus on value communication improvements.
              </div>
            </div>

            <div class="insight-box">
              <div class="insight-title">The Billing Crisis: Regulatory Data Correlation</div>
              <div class="insight-content">
                <span class="highlight-metric">CCTS: 42.4% billing complaints</span> (6,752 of 15,913) vs <span class="highlight-metric">Apps: 4.0% billing reviews</span> (396 of 10,103) reveals a dangerous disconnect.<br /><br />
                
                <span class="highlight-metric">Top CCTS Issues Mirror App Failures:</span><br />
                • Incorrect charges: 2,897 complaints (18.2%)<br />
                • Credit/refund issues: 2,187 complaints (13.7%)<br />
                • Contract conflicts: 2,009 complaints (12.6%)<br />
                • Price increases: 1,668 complaints (10.5%)<br /><br />
                
                Our app analysis shows authentication failures (719 reviews), payment processing issues (396 reviews), and pricing complaints (583 reviews) create the perfect storm for regulatory escalation.<br /><br />
                <span class="highlight-metric">Economic Impact:</span> Each CCTS complaint costs $2,500-6,500 to resolve. Preventing 50% through improved app reliability could save $8-22M annually. Our data proves app problems directly predict regulatory complaints with mathematical precision.
              </div>
            </div>

            <div class="insight-box">
              <div class="insight-title">Smart CX Through Data Precision</div>
              <div class="insight-content">
                <span class="highlight-metric">Enhanced AI categorization</span> of 10,103 reviews into 28 specific categories revealed hidden patterns invisible in traditional analysis:<br /><br />
                
                <span class="highlight-metric">Breaking Point Analysis:</span><br />
                • Authentication: 719 failures (7.1%) - blocks basic access<br />
                • App crashes: 501 incidents (5.0%) - destroys reliability perception<br />
                • Payment issues: 396 problems (3.9%) - directly escalates to CCTS<br />
                • Performance: 815 complaints (8.1%) - drives competitive switching<br /><br />
                
                <span class="highlight-metric">Predictive Power:</span> Our app hierarchy directly correlates with CCTS complaint distribution - proving customer frustration follows predictable patterns that smart CX can intercept.<br /><br />
                
                <span class="highlight-metric">Rogers vs Bell:</span> Rogers shows 4-6x higher technical failure rates (authentication, crashes, performance) while Bell shows better strategic UX decisions but higher pricing sensitivity.
              </div>
            </div>

            <div class="insight-box">
              <div class="insight-title">
                Bell's Smart CX Decisions: Evidence from App Design
              </div>
              <div class="insight-content">
                Visual analysis confirms Bell's strategic advantages despite
                identical functionality:<br /><br />
                <span class="highlight-metric">1) Hidden complexity</span> -
                Chat requires 3 taps but delivers humans immediately (vs Rogers'
                instant chat that deflects).<br /><br />
                <span class="highlight-metric">2) Priority hierarchy</span> -
                Core functions (usage/billing) above promotions (vs Rogers'
                credit card ads competing with bill payment).<br /><br />
                <span class="highlight-metric">3) Payment transparency</span> -
                Shows current payment method before asking for alternatives (vs
                Rogers' confusing credit-first approach).<br /><br />
                <span class="highlight-metric">Data Validation:</span> Despite Rogers having 2.3x more reviews (7,055 vs 3,048), Rogers shows disproportionately higher technical failure rates:<br />
                • Authentication: 6x higher (616 vs 103)<br />
                • App crashes: 4.8x higher (414 vs 87)<br />
                • Performance: 4.7x higher (671 vs 144)<br /><br />
                
                This suggests Bell's UX architecture creates measurable resilience advantages, while Rogers faces critical technical debt requiring platform stabilization investment.
              </div>
            </div>
          </div>

          <!-- Key Visualizations -->
          <div class="grid grid-1">
            <div class="card">
              <div class="card-header">
                <div>
                  <h3 class="card-title">Issue Categories</h3>
                  <p class="card-subtitle" id="categorySubtitle">
                    Primary complaint drivers from 10,103 customer reviews
                    (excludes positive feedback)
                  </p>
                </div>
              </div>
              <div style="padding: 0 1rem">
                <div class="segmented-control" id="categoryChartFilter">
                  <button class="segmented-option active" data-value="both">
                    Both
                  </button>
                  <button class="segmented-option" data-value="rogers">
                    Rogers
                  </button>
                  <button class="segmented-option" data-value="bell">
                    Bell
                  </button>
                </div>
              </div>
              <div
                class="chart-container"
                style="min-height: 600px; max-width: 700px; margin: 0 auto"
              >
                <div id="topIssuesChart" style="height: 600px"></div>
                <div
                  id="chartInsights"
                  style="
                    margin-top: 15px;
                    padding: 15px;
                    background: rgba(0, 0, 0, 0.02);
                    border-radius: 8px;
                    font-size: 0.9rem;
                    color: #666;
                    line-height: 1.4;
                  "
                >
                  <!-- Dynamic insights will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Data Analysis Tab -->
        <div id="analysis" class="tab-content">
          <!-- Filters -->
          <div class="filters-section">
            <div class="filters-header">
              <h3 class="filters-title">
                <i class="fas fa-filter"></i> Data Filters
              </h3>
              <span
                id="filterStatus"
                style="font-size: 0.875rem; color: var(--ey-gray-dark)"
              ></span>
            </div>

            <div class="filter-grid">
              <div class="filter-group">
                <label class="filter-label">Issue Category</label>
                <select
                  class="filter-input"
                  id="categoryFilter"
                  onchange="applyFilters()"
                >
                  <option value="all">All Categories</option>
                  <option value="Performance">Performance (815)</option>
                  <option value="App Praise">App Praise (1,735)</option>
                  <option value="General Dissatisfaction">
                    General Dissatisfaction (709)
                  </option>
                  <option value="App Complaints">App Complaints (1,206)</option>
                  <option value="Customer Support">
                    Customer Support (269)
                  </option>
                  <option value="User Experience">User Experience (583)</option>
                  <option value="Technical Issues">
                    Technical Issues (670)
                  </option>
                  <option value="Authentication">Authentication (719)</option>
                  <option value="Brand Loyalty">Brand Loyalty (330)</option>
                  <option value="Pricing/Value Comments">
                    Pricing/Value Comments (541)
                  </option>
                  <option value="Payment Issues">Payment Issues (396)</option>
                  <option value="Service Quality">Service Quality (545)</option>
                  <option value="Billing">Billing (363)</option>
                  <option value="Service Issues">Service Issues (158)</option>
                  <option value="Features">Features (198)</option>
                  <option value="App Crashes">App Crashes (501)</option>
                  <option value="Network Issues">Network Issues (141)</option>
                  <option value="Coverage Issues">Coverage Issues (50)</option>
                  <option value="Price Increases">Price Increases (42)</option>
                  <option value="Account Management">
                    Account Management (35)
                  </option>
                  <option value="Security">Security (25)</option>
                  <option value="Competitive Comparisons">
                    Competitive Comparisons (24)
                  </option>
                  <option value="Data Usage">Data Usage (21)</option>
                  <option value="Notifications">Notifications (16)</option>
                  <option value="Roaming Issues">Roaming Issues (8)</option>
                </select>
              </div>

              <div class="filter-group">
                <label class="filter-label">Provider</label>
                <select
                  class="filter-input"
                  id="appFilter"
                  onchange="applyFilters()"
                >
                  <option value="all">All Providers</option>
                  <option value="Rogers">Rogers</option>
                  <option value="Bell">Bell</option>
                </select>
              </div>

              <div class="filter-group">
                <label class="filter-label">Platform</label>
                <select
                  class="filter-input"
                  id="platformFilter"
                  onchange="applyFilters()"
                >
                  <option value="all">All Platforms</option>
                  <option value="iOS">iOS</option>
                  <option value="Android">Android</option>
                </select>
              </div>

              <div class="filter-group">
                <label class="filter-label">Search Reviews</label>
                <input
                  type="text"
                  class="filter-input"
                  id="searchFilter"
                  placeholder="Enter keywords..."
                  onkeyup="applyFilters()"
                />
              </div>
            </div>
          </div>

          <!-- Data Table -->
          <div class="card">
            <div class="card-header">
              <div>
                <h3 class="card-title">Customer Review Details</h3>
                <p class="card-subtitle">Filtered results from analysis</p>
              </div>
            </div>
            <div style="overflow-x: auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Provider</th>
                    <th>Platform</th>
                    <th>Rating</th>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Review</th>
                  </tr>
                </thead>
                <tbody id="reviewsTableBody">
                  <!-- Dynamic content -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Strategic Report Tab -->
        <div id="report" class="tab-content">
          <div class="report-section">
            <div class="report-header">
              <h1 class="report-title">Rogers CX Transformation Strategy</h1>
              <p class="report-subtitle">
                From Edge Case Mastery to Market Leadership
              </p>
            </div>

            <div class="report-content">
              <h2>Executive Summary</h2>
              <p>
                <strong>Bell's Design Advantage is Meaningless:</strong> Despite
                superior UI, Bell performs identically to Rogers (both 2.64/5
                rating). Our analysis of 12,785 app reviews reveals that success
                isn't about design—it's about core function reliability.
              </p>

              <h3>The Telecom App Hierarchy of Needs</h3>
              <ol>
                <li>
                  <strong>Core Function Reliability</strong> (Technical 94.9%
                  negative + Billing 77.6% negative)
                </li>
                <li>
                  <strong>Human Support Access</strong> (When #1 fails - 12%
                  need human help)
                </li>
                <li>
                  <strong>Performance</strong> (Speed, stability - 6.1% of
                  complaints)
                </li>
                <li>
                  <strong>User Experience</strong> (Design, navigation - only
                  33.7% negative)
                </li>
              </ol>

              <h3>Key Findings</h3>
              <ul>
                <li>
                  <strong>The Two-Speed Reality:</strong> 99.94% of users don't
                  write reviews (satisfied), while 0.06% of users write reviews¹
                  experience critical failures (2.64/5 average rating)
                </li>
                <li>
                  <strong>Critical Failure Points:</strong> Login success rate
                  of only 7.7% and payment success rate of 30.0% among
                  frustrated reviewers
                </li>
                <li>
                  <strong>Platform Crisis:</strong> iOS users experience 84.2%
                  negative sentiment vs 58.1% on Android
                </li>
                <li>
                  <strong>CCTS Pipeline:</strong> App failures → Support
                  contacts → CCTS complaints (42.4% billing-related)
                </li>
              </ul>

              <h3>Strategic Recommendations</h3>
              <p>
                <strong>Build a "banking app that pays telecom bills"</strong> -
                Focus on bulletproof core functions:
              </p>

              <h4>Priority 1: Core Function Reliability</h4>
              <ul>
                <li>Fix authentication failures (currently 92.3% negative)</li>
                <li>
                  Ensure payment processing always works (currently 70%
                  negative)
                </li>
                <li>Eliminate technical issues (currently 94.9% negative)</li>
              </ul>

              <h4>Priority 2: Seamless Support Access</h4>
              <ul>
                <li>Build intelligent escalation paths when digital fails</li>
                <li>Preserve context across channels</li>
                <li>Reduce forced channel switching (currently 12%)</li>
              </ul>

              <h4>Priority 3: Banking-Level Performance</h4>
              <ul>
                <li>Match banking app stability standards</li>
                <li>Platform parity (close 26-point iOS-Android gap)</li>
                <li>Proactive failure prevention</li>
              </ul>

              <h3>Business Case</h3>
              <p>
                <strong>The Opportunity:</strong> Transform Rogers from
                complaint management to prevention leadership by fixing core
                functions that currently fail. Every prevented edge case
                eliminates support costs and CCTS escalations while building
                customer trust.
              </p>

              <h3>The Winning Formula</h3>
              <p>
                <strong>Build a "banking app that pays telecom bills."</strong>
                Focus technical investment on bulletproof core functions rather
                than UI polish. The data proves Rogers can achieve market
                leadership by being the first telecom provider to deliver
                banking-app reliability for basic customer needs.
              </p>

              <div
                style="
                  margin-top: 3rem;
                  padding-top: 2rem;
                  border-top: 1px solid var(--ey-gray-light);
                "
              >
                <p style="font-size: 0.875rem; color: var(--ey-gray-dark)">
                  <sup>¹</sup>Industry estimate - requires verification with
                  actual user base data<br />
                  <sup>²</sup>Industry estimate - citation needed
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Research Methodology Tab -->
        <div id="methodology" class="tab-content">
          <div class="report-section">
            <div class="report-header">
              <h1 class="report-title">Research Methodology</h1>
              <p class="report-subtitle">
                How we analyzed 12,785 reviews to derive actionable insights
              </p>
            </div>

            <div class="report-content">
              <h2>Overview</h2>
              <p>
                Our comprehensive analysis employed a multi-phase approach to
                extract actionable insights from telecom customer feedback. We
                combined large-scale data extraction, AI-powered analysis, and
                statistical validation to understand the critical failure points
                driving customer frustration.
              </p>

              <h3>Data Collection Process</h3>

              <h4>Review Extraction</h4>
              <ul>
                <li>
                  <strong>Initial Extraction:</strong> 30,000+ app reviews
                  collected across iOS App Store and Google Play Store
                </li>
                <li>
                  <strong>Providers:</strong> Rogers (MyRogers app) and Bell
                  (MyBell app)
                </li>
                <li>
                  <strong>Platforms:</strong> All iOS reviews plus
                  representative Android sample
                </li>
                <li>
                  <strong>Analysis Method:</strong> Individual AI analysis using
                  Anthropic's Claude API
                </li>
              </ul>

              <h4>Data Processing</h4>
              <ul>
                <li>
                  <strong>Deduplication:</strong> Removed duplicate reviews
                  based on ID and timestamp
                </li>
                <li>
                  <strong>Quality Check:</strong> Verified review authenticity,
                  removed spam
                </li>
                <li>
                  <strong>Final Dataset:</strong> 12,785 high-quality, unique
                  reviews
                </li>
                <li>
                  <strong>Breakdown:</strong> Rogers: 9,038 reviews (70.7%),
                  Bell: 3,747 reviews (29.3%)
                </li>
              </ul>

              <h4>CCTS Integration</h4>
              <ul>
                <li>
                  <strong>Source:</strong> Commission for Complaints for
                  Telecom-television Services
                </li>
                <li>
                  <strong>Period:</strong> August 2024 - January 2025 (6 months)
                </li>
                <li>
                  <strong>Volume:</strong> 15,913 formal complaints from ALL
                  providers
                </li>
                <li>
                  <strong>Breakdown:</strong> Rogers+Fido: 3,792 (23.8%), Bell:
                  2,916 (18.3%), Others: 9,205 (57.9%)
                </li>
                <li>
                  <strong>Purpose:</strong> Validate app issues against
                  regulatory escalations
                </li>
              </ul>

              <h3>Analysis Methodology</h3>

              <h4>AI-Powered Categorization</h4>
              <p>
                Each of the 12,785 reviews was analyzed using Claude AI
                (Anthropic) for:
              </p>
              <ul>
                <li>Sentiment classification (Positive/Negative/Neutral)</li>
                <li>
                  Primary issue category (Technical/Billing/UX/Features/Support)
                </li>
                <li>Severity assessment (Critical/High/Medium/Low)</li>
                <li>Customer service impact prediction</li>
                <li>Feature and issue tagging</li>
              </ul>

              <h4>Statistical Analysis</h4>
              <ul>
                <li>
                  <strong>Confidence Level:</strong> 95% CI with ±0.8% margin of
                  error
                </li>
                <li>
                  <strong>Platform Comparison:</strong> iOS (84.2% negative) vs
                  Android (58.1% negative)
                </li>
                <li>
                  <strong>Provider Analysis:</strong> Rogers (9,038 reviews) vs
                  Bell (3,747 reviews)
                </li>
                <li>
                  <strong>Journey Mapping:</strong> Authentication → Payment →
                  Support paths
                </li>
              </ul>

              <h3>Key Insights Approach</h3>

              <h4>The "Breaking Point" Focus</h4>
              <p>
                We discovered that written reviews represent only 0.06% of
                users—those experiencing "breaking point" failures. This makes
                our dataset extraordinarily valuable for preventing CCTS
                escalations, as these users show us exactly where and how the
                app fails in critical moments.
              </p>

              <h4>Edge Case Identification</h4>
              <ul>
                <li>
                  <strong>Login Success:</strong> Only 7.7% positive (99/1,290
                  mentions)
                </li>
                <li>
                  <strong>Payment Success:</strong> Only 30.0% positive
                  (712/2,377 mentions)
                </li>
                <li>
                  <strong>Technical Issues:</strong> 94.9% negative sentiment
                  (highest of all categories)
                </li>
                <li>
                  <strong>Channel Switching:</strong> 12% forced to human
                  support
                </li>
              </ul>

              <h3>Quality Assurance</h3>
              <ul>
                <li>
                  <strong>Manual Validation:</strong> 5% of AI categorizations
                  spot-checked
                </li>
                <li>
                  <strong>Cross-Validation:</strong> Review insights compared
                  with CCTS data
                </li>
                <li>
                  <strong>Statistical Significance:</strong> All reported
                  differences exceed margin of error
                </li>
              </ul>

              <h3>Deliverables</h3>
              <ul>
                <li>12,785 individually analyzed and categorized reviews</li>
                <li>Statistical breakdowns with confidence intervals</li>
                <li>Journey failure point identification</li>
                <li>Strategic priorities for edge case prevention</li>
                <li>Implementation roadmap for edge case mastery</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- All Reports Tab -->
        <div id="reports" class="tab-content">
          <div class="container" style="max-width: 1200px">
            <h2 style="margin-bottom: 2rem">Analysis Reports</h2>

            <!-- Provider-Specific Reports Section -->
            <div style="margin-bottom: 3rem">
              <h3
                style="
                  color: var(--ey-gray-dark);
                  margin-bottom: 1.5rem;
                  font-size: 1.25rem;
                  font-weight: 600;
                "
              >
                Provider-Specific Strategic Reports
              </h3>
              <div class="grid grid-2" style="gap: 2rem">
                <div
                  class="card rogers-branded"
                  data-report="rogers"
                  style="display: flex; flex-direction: column"
                >
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">
                        Rogers CX Transformation Report
                      </h3>
                      <p class="card-subtitle">
                        Strategic recommendations for edge case mastery
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      Comprehensive analysis showing how Rogers can transform
                      from reactive complaint management to proactive edge case
                      mastery through the banking app standard.
                    </p>

                    <div style="margin-top: auto">
                      <a
                        href="rogers_cx_transformation_report.html"
                        class="rogers-button"
                        style="
                          display: inline-block;
                          background: var(--rogers-red);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Rogers Report →</a
                      >
                    </div>
                  </div>
                </div>

                <div
                  class="card bell-branded"
                  data-report="bell"
                  style="display: flex; flex-direction: column"
                >
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">Bell's Smart CX Decisions</h3>
                      <p class="card-subtitle">
                        Visual analysis of Bell's UX advantage
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      How Bell generates
                      <span class="highlight-metric"
                        >8x fewer chatbot complaints</span
                      >
                      through three deliberate UX decisions that acknowledge
                      users' emotional state and prevent CCTS escalations.
                    </p>

                    <div style="margin-top: auto">
                      <a
                        href="bell_smart_cx_report.html"
                        style="
                          display: inline-block;
                          background: var(--bell-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Bell Report →</a
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Executive & Summary Reports Section -->
            <div style="margin-bottom: 3rem">
              <h3
                style="
                  color: var(--ey-gray-dark);
                  margin-bottom: 1.5rem;
                  font-size: 1.25rem;
                  font-weight: 600;
                "
              >
                Executive Overview & Key Findings
              </h3>
              <div class="grid grid-2" style="gap: 2rem">
                <div class="card" style="display: flex; flex-direction: column">
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">Executive Summary</h3>
                      <p class="card-subtitle">
                        High-level findings and recommendations
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      Concise overview of the telecom app hierarchy of needs,
                      showing why Bell's design advantage is meaningless and how
                      to build a banking app standard.
                    </p>
                    <div style="margin-top: auto">
                      <a
                        href="executive_summary.html"
                        style="
                          display: inline-block;
                          background: var(--ey-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Report →</a
                      >
                    </div>
                  </div>
                </div>

                <div class="card" style="display: flex; flex-direction: column">
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">CX/UX Assessment Report</h3>
                      <p class="card-subtitle">
                        Detailed customer experience analysis
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      In-depth assessment of Rogers vs Bell mobile applications
                      against CX/UX principles, revealing journey orchestration
                      failures.
                    </p>
                    <div style="margin-top: auto">
                      <a
                        href="cx_ux_assessment_report.html"
                        style="
                          display: inline-block;
                          background: var(--ey-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Report →</a
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Data & Methodology Reports Section -->
            <div style="margin-bottom: 3rem">
              <h3
                style="
                  color: var(--ey-gray-dark);
                  margin-bottom: 1.5rem;
                  font-size: 1.25rem;
                  font-weight: 600;
                "
              >
                Data Analysis & Research Methodology
              </h3>
              <div class="grid grid-2" style="gap: 2rem">
                <div class="card" style="display: flex; flex-direction: column">
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">
                        Metrics Calculations & Verification
                      </h3>
                      <p class="card-subtitle">
                        Statistical rigor behind every metric presented
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      Transparency on how we calculated sentiment rates,
                      platform differences, review statistics, and confidence
                      intervals. Includes verification status for all key
                      metrics.
                    </p>
                    <div style="margin-top: auto">
                      <a
                        href="metrics_calculations_verification.html"
                        style="
                          display: inline-block;
                          background: var(--ey-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Report →</a
                      >
                    </div>
                  </div>
                </div>

                <div class="card" style="display: flex; flex-direction: column">
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">Research Process & Approach</h3>
                      <p class="card-subtitle">
                        Data collection, AI analysis methodology, and validation
                        process
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      Comprehensive explanation of our structured approach to
                      extract actionable insights from 12,785 app reviews and
                      15,913 CCTS complaints, including AI categorization
                      methods and statistical validation.
                    </p>
                    <div style="margin-top: auto">
                      <a
                        href="research_process_approach.html"
                        style="
                          display: inline-block;
                          background: var(--ey-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Report →</a
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Quick Reference Reports Section -->
            <div style="margin-bottom: 3rem">
              <h3
                style="
                  color: var(--ey-gray-dark);
                  margin-bottom: 1.5rem;
                  font-size: 1.25rem;
                  font-weight: 600;
                "
              >
                Quick Reference & Lookup
              </h3>
              <div class="grid grid-2" style="gap: 2rem">
                <div class="card" style="display: flex; flex-direction: column">
                  <div class="card-header">
                    <div>
                      <h3 class="card-title">Key Metrics Quick Reference</h3>
                      <p class="card-subtitle">
                        All verified metrics at a glance
                      </p>
                    </div>
                  </div>
                  <div
                    style="
                      padding: 0;
                      flex: 1;
                      display: flex;
                      flex-direction: column;
                    "
                  >
                    <p style="margin-bottom: 1.5rem; flex: 1">
                      Quick reference guide showing core metrics, calculations,
                      and confidence intervals for all key findings.
                    </p>
                    <div style="margin-top: auto">
                      <a
                        href="key_metrics_reference.html"
                        style="
                          display: inline-block;
                          background: var(--ey-blue);
                          color: white;
                          border: none;
                          padding: 0.75rem 1.5rem;
                          border-radius: 4px;
                          font-weight: 600;
                          text-decoration: none;
                        "
                        >View Report →</a
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Report Viewer -->
            <div id="reportViewer" style="display: none; margin-top: 2rem">
              <div class="card">
                <div
                  class="card-header"
                  style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                  "
                >
                  <div>
                    <h3 class="card-title" id="reportTitle">Report Title</h3>
                    <p class="card-subtitle">Viewing markdown report</p>
                  </div>
                  <button
                    onclick="closeReport()"
                    style="
                      background: var(--ey-gray-dark);
                      color: white;
                      border: none;
                      padding: 0.5rem 1rem;
                      border-radius: 4px;
                      cursor: pointer;
                    "
                  >
                    ← Back to Reports
                  </button>
                </div>
                <div
                  id="reportContent"
                  style="
                    padding: 2rem;
                    max-width: 900px;
                    margin: 0 auto;
                    line-height: 1.8;
                  "
                >
                  <!-- Markdown content will be rendered here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Shared Navigation -->
    <script src="shared-navigation.js"></script>

    <!-- Dashboard Scripts -->
    <script src="dashboard_complete_enhanced.js"></script>
    <script>
      // Standalone mode - disable data loading
      let dashboardData = null;

      // Initialize dashboard without external data loading
      function initializeStandaloneMode() {
        // Check if data is already loaded by dashboard_final.js
        if (typeof window.dashboardData !== "undefined") {
          dashboardData = window.dashboardData;
          console.log(
            "Using dashboard_final.js data:",
            dashboardData.summary.total_reviews,
            "reviews"
          );
          populateDataTable();
          updateMetrics();
          createCategoryChart();
        } else if (typeof ENHANCED_DASHBOARD_DATA !== "undefined") {
          dashboardData = ENHANCED_DASHBOARD_DATA;
          console.log(
            "Loaded embedded data:",
            dashboardData.summary.total_reviews,
            "reviews"
          );
          populateDataTable();
          updateMetrics();
          createCategoryChart();
        } else {
          console.log("Using static data mode");
        }

        // Hide loading screen and show dashboard
        setTimeout(() => {
          document.getElementById("loading").style.display = "none";
          document.getElementById("dashboard").style.display = "block";
          console.log("✅ Dashboard displayed successfully");
          // Initialize chart filters after dashboard is shown
          initializeChartFilters();
        }, 500);
      }

      // Populate data table with embedded data
      function populateDataTable() {
        if (!dashboardData || !dashboardData.reviews) {
          // Use sample data if no embedded reviews
          document.getElementById("reviewsTableBody").innerHTML = `
                          <tr>
                              <td>Rogers</td>
                              <td>iOS</td>
                              <td>1</td>
                              <td>2025-05-15</td>
                              <td>Technical Issues</td>
                              <td>App crashes constantly, can't login...</td>
                          </tr>
                          <tr>
                              <td>Bell</td>
                              <td>Android</td>
                              <td>5</td>
                              <td>2025-05-20</td>
                              <td>User Experience</td>
                              <td>Works great, easy to use interface...</td>
                          </tr>
                          <tr>
                              <td colspan="6" style="text-align: center; padding: 2rem; color: var(--ey-gray-dark);">
                                  <i class="fas fa-info-circle"></i> Sample data shown. Full dataset available in analysis mode.
                              </td>
                          </tr>
                      `;
          return;
        }

        // Populate with actual data if available
        const tbody = document.getElementById("reviewsTableBody");
        const reviews = dashboardData.reviews; // Show all reviews

        tbody.innerHTML = reviews
          .map(
            (review) => `
                      <tr>
                          <td>${review.app || "Unknown"}</td>
                          <td>${review.platform || "Unknown"}</td>
                          <td>${review.rating || "N/A"}</td>
                          <td>${
                            review.date
                              ? new Date(review.date).toLocaleDateString()
                              : "N/A"
                          }</td>
                          <td>${review.category || "General"}</td>
                          <td>${review.content || ""}</td>
                      </tr>
                  `
          )
          .join("");
      }

      // Update metrics with embedded data
      function updateMetrics() {
        if (dashboardData && dashboardData.summary) {
          const summary = dashboardData.summary;
          document.getElementById("totalReviews").textContent =
            summary.total_reviews.toLocaleString();
          document.getElementById("avgRating").textContent =
            summary.average_rating.toFixed(2);
        }
      }

      // Tab Management
      window.showTab = function (tabName) {
        // Update nav - remove all active states first
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Find and activate only the correct tab
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          const tabText = tab.textContent.trim();
          let shouldActivate = false;

          switch (tabName) {
            case "insights":
              shouldActivate = tabText === "Executive Insights";
              break;
            case "analysis":
              shouldActivate = tabText === "Reviews";
              break;
            case "report":
              shouldActivate = tabText === "Strategic Report";
              break;
            case "methodology":
              shouldActivate = tabText === "Research Methodology";
              break;
            case "reports":
              shouldActivate = tabText === "All Reports";
              break;
          }

          if (shouldActivate) {
            tab.classList.add("active");
          }
        });

        // Update content
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.remove("active");
        });
        const targetContent = document.getElementById(tabName);
        if (targetContent) {
          targetContent.classList.add("active");
        }

        // Update URL
        const url = new URL(window.location);
        url.searchParams.set("tab", tabName);
        window.history.pushState({ tab: tabName }, "", url);
      };

      // Dashboard initialization is now handled by dashboard_final.js
      // Our custom functions are available if needed

      // Color mapping functions for consistent chart colors
      function getSentimentColors(sentimentLabels) {
        const sentimentColorMap = {
          Negative: "#EE3124", // EY Red - for negative sentiment
          Positive: "#00A88E", // EY Green - for positive sentiment
          Neutral: "#747480", // EY Gray - for neutral sentiment
          Mixed: "#FFE600", // EY Yellow - for mixed sentiment
        };

        return sentimentLabels.map(
          (label) => sentimentColorMap[label] || "#747480"
        );
      }

      function getCategoryColors(categoryLabels) {
        // Standard color mapping for each category - consistent across all filters
        const categoryColorMap = {
          Performance: "#EE3124", // EY Red - critical performance issues
          "App Praise": "#00A88E", // EY Green - positive feedback
          "General Dissatisfaction": "#747480", // EY Gray - general negative
          "App Complaints": "#FFE600", // EY Yellow - app-specific issues
          "Customer Support": "#00A3E0", // EY Blue - service-related
          "User Experience": "#7E3F98", // EY Purple - UX feedback
          "Technical Issues": "#e20a16", // Rogers Red - technical problems
          Authentication: "#0066cc", // Bell Blue - login/access issues
          "Brand Loyalty": "#2E2E38", // EY Dark Gray - loyalty feedback
          "Pricing/Value Comments": "#C4C4CD", // EY Light Gray - pricing
          "Payment Issues": "#ff6b35", // Orange - payment problems
          "Service Quality": "#4ecdc4", // Teal - service quality
          Billing: "#45b7d1", // Light Blue - billing issues
          "Service Issues": "#96ceb4", // Light Green - service problems
          Features: "#ffeaa7", // Light Yellow - feature requests
          "App Crashes": "#d63031", // Dark Red - crashes
          "Network Issues": "#6c5ce7", // Purple - network problems
          "Coverage Issues": "#a29bfe", // Light Purple - coverage
          "Price Increases": "#fd79a8", // Pink - price increases
          "Account Management": "#fdcb6e", // Gold - account issues
          Security: "#e84393", // Magenta - security concerns
          "Competitive Comparisons": "#81ecec", // Cyan - comparisons
          "Data Usage": "#fab1a0", // Peach - data issues
          Notifications: "#00b894", // Dark Teal - notification issues
          "Roaming Issues": "#e17055", // Coral - roaming problems
          "Security Concerns": "#e84393", // Magenta - security concerns (alternative name)
          "Billing/Payments": "#45b7d1", // Light Blue - billing/payments (alternative name)
          "This review does not contain any meaningful text, so it cannot be categorized into any of the provide":
            "#747480", // Gray - uncategorized
        };

        return categoryLabels.map(
          (category) => categoryColorMap[category] || "#747480"
        );
      }

      // Create working Plotly charts

      function createCategoryChart() {
        const chartElement = document.getElementById("topIssuesChart");
        if (!chartElement || typeof Plotly === "undefined") {
          console.error(
            "Cannot create category chart - element or Plotly not found"
          );
          return;
        }

        // Get current filter value
        const currentFilter = window.currentCategoryFilter || "both";
        let allCategories = {},
          chartTitle = "";

        if (currentFilter === "rogers") {
          const rogersReviews = dashboardData.reviews.filter(
            (r) => r.app.toLowerCase() === "rogers"
          );
          rogersReviews.forEach((review) => {
            if (review.category && review.category !== "App Praise") {
              allCategories[review.category] =
                (allCategories[review.category] || 0) + 1;
            }
          });
          chartTitle = "";
        } else if (currentFilter === "bell") {
          const bellReviews = dashboardData.reviews.filter(
            (r) => r.app.toLowerCase() === "bell"
          );
          bellReviews.forEach((review) => {
            if (review.category && review.category !== "App Praise") {
              allCategories[review.category] =
                (allCategories[review.category] || 0) + 1;
            }
          });
          chartTitle = "";
        } else {
          // Calculate from full review data, excluding App Praise
          dashboardData.reviews.forEach((review) => {
            if (review.category && review.category !== "App Praise") {
              allCategories[review.category] =
                (allCategories[review.category] || 0) + 1;
            }
          });
          chartTitle = "";
        }

        // Get top 8 categories for better visualization
        const topCategories = Object.entries(allCategories)
          .sort(([, a], [, b]) => b - a)
          .slice(0, 8);

        const plotData = [
          {
            values: topCategories.map(([, count]) => count),
            labels: topCategories.map(([name]) => name),
            type: "pie",
            hole: 0.3,
            marker: {
              colors: getCategoryColors(topCategories.map(([name]) => name)),
            },
            textinfo: "label+percent",
            hovertemplate:
              "<b>%{label}</b><br>Count: %{value}<br>%{percent}<extra></extra>",
          },
        ];

        const layout = {
          title: {
            text: chartTitle,
            font: { size: 14, family: "Inter, sans-serif" },
            y: 0.95,
          },
          margin: { t: 40, b: 100, l: 40, r: 40 },
          font: { family: "Inter, sans-serif", size: 12 },
          paper_bgcolor: "rgba(0,0,0,0)",
          plot_bgcolor: "rgba(0,0,0,0)",
          showlegend: true,
          legend: {
            orientation: "h",
            y: -0.35,
            xanchor: "center",
            x: 0.5,
            font: { size: 11 },
          },
        };

        const config = {
          responsive: true,
          displayModeBar: false,
          autosizable: true,
        };

        try {
          Plotly.newPlot("topIssuesChart", plotData, layout, config);
          // Force chart to center properly after initial render
          setTimeout(() => {
            Plotly.Plots.resize("topIssuesChart");
          }, 100);
          console.log("✅ Category chart created successfully");

          // Update insights based on current filter
          updateChartInsights(currentFilter);
        } catch (error) {
          console.error("❌ Error creating category chart:", error);
        }
      }

      // Update chart insights based on current filter
      function updateChartInsights(currentFilter) {
        const insightsElement = document.getElementById("chartInsights");
        if (!insightsElement) return;

        let insights = [];

        if (currentFilter === "rogers") {
          insights = [
            "Authentication issues are 6x more common for Rogers users (616 vs 103 Bell reviews)",
            "App crashes affect Rogers users 4.8x more frequently than Bell users",
            "Performance complaints are 4.7x higher for Rogers compared to Bell",
          ];
        } else if (currentFilter === "bell") {
          insights = [
            "Pricing/Value Comments rank #2 for Bell but only #9 for Rogers users",
            "Bell users report more billing-related issues relative to their user base",
            "Payment issues rank higher in Bell's top concerns compared to Rogers",
          ];
        } else {
          insights = [
            "Rogers users report significantly more authentication and performance issues",
            "Bell users express more pricing and billing concerns relative to their user base",
            "App crashes appear in Rogers' top 8 issues but not Bell's due to volume differences",
          ];
        }

        const insightsHtml = insights
          .map(
            (insight) =>
              `<div style="margin-bottom: 8px;"><span style="color: var(--ey-blue); font-weight: 500;">💡</span> ${insight}</div>`
          )
          .join("");

        insightsElement.innerHTML = `
          <div style="font-weight: 500; margin-bottom: 10px; color: #444;">
            📊 Key Insights
          </div>
          ${insightsHtml}
        `;
      }

      // Filter functionality
      function applyFilters() {
        const category = document.getElementById("categoryFilter").value;
        const provider = document.getElementById("appFilter").value;
        const platform = document.getElementById("platformFilter").value;
        const searchTerm = document
          .getElementById("searchFilter")
          .value.toLowerCase();

        console.log("🔍 Applying filters:", {
          category,
          provider,
          platform,
          searchTerm,
        });
        console.log(
          "📊 Available data:",
          dashboardData ? dashboardData.summary.total_reviews : "No data"
        );

        // Update filter status
        let activeFilters = [];
        if (category !== "all") activeFilters.push(category);
        if (provider !== "all") activeFilters.push(provider);
        if (platform !== "all") activeFilters.push(platform);
        if (searchTerm) activeFilters.push("Search: " + searchTerm);

        document.getElementById("filterStatus").textContent =
          activeFilters.length > 0
            ? "Active filters: " + activeFilters.join(", ")
            : "";

        // Apply filters to embedded data
        if (dashboardData && dashboardData.reviews) {
          let filteredReviews = dashboardData.reviews;

          if (category !== "all") {
            filteredReviews = filteredReviews.filter((review) =>
              (review.category || "General").includes(category)
            );
          }
          if (provider !== "all") {
            filteredReviews = filteredReviews.filter(
              (review) =>
                (review.app || "").toLowerCase() === provider.toLowerCase()
            );
          }
          if (platform !== "all") {
            filteredReviews = filteredReviews.filter(
              (review) =>
                (review.platform || "").toLowerCase() === platform.toLowerCase()
            );
          }
          if (searchTerm) {
            filteredReviews = filteredReviews.filter((review) =>
              (review.content || "").toLowerCase().includes(searchTerm)
            );
          }

          // Update table with filtered results
          updateTableWithReviews(filteredReviews);
          console.log("✅ Filtered to", filteredReviews.length, "reviews");
          if (provider === "Rogers") {
            console.log(
              "🔍 Sample Rogers reviews found:",
              filteredReviews
                .slice(0, 3)
                .map((r) => ({
                  app: r.app,
                  platform: r.platform,
                  rating: r.rating,
                }))
            );
          }
        } else {
          console.log("No embedded data to filter");
        }
      }

      // Update table with specific reviews
      function updateTableWithReviews(reviews) {
        const tbody = document.getElementById("reviewsTableBody");
        if (reviews.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No reviews match the current filters</td></tr>';
          return;
        }

        tbody.innerHTML = reviews
          .map(
            (review) => `
                      <tr>
                          <td>${review.app || "Unknown"}</td>
                          <td>${review.platform || "Unknown"}</td>
                          <td>${review.rating || "N/A"}</td>
                          <td>${
                            review.date
                              ? new Date(review.date).toLocaleDateString()
                              : "N/A"
                          }</td>
                          <td>${review.category || "General"}</td>
                          <td>${review.content || ""}</td>
                      </tr>
                  `
          )
          .join("");
      }

      // Markdown Report Viewer Functions
      async function loadReport(filename, title) {
        try {
          // Show loading state
          document.getElementById("reportsList").style.display = "none";
          document.getElementById("reportViewer").style.display = "block";
          document.getElementById("reportTitle").textContent = title;
          document.getElementById("reportContent").innerHTML =
            "<p>Loading report...</p>";

          // Try to fetch the markdown file
          let markdown = "";

          try {
            const response = await fetch(`./${filename}`);
            if (response.ok) {
              markdown = await response.text();
            } else {
              throw new Error("Fetch failed");
            }
          } catch (fetchError) {
            // If fetch fails (likely due to CORS), provide instructions
            markdown = getReportFallback(filename);
          }

          // Configure marked options for better rendering
          marked.setOptions({
            breaks: true,
            gfm: true,
            headerIds: true,
            mangle: false,
          });

          // Render markdown to HTML
          const html = marked.parse(markdown);

          // Display the rendered content with EY styling
          document.getElementById("reportContent").innerHTML = `
                          <div class="markdown-content">
                              ${html}
                          </div>
                      `;

          // Style the markdown content
          const style = document.createElement("style");
          style.textContent = `
                          .markdown-content {
                              font-family: 'Inter', 'EYInterstate', -apple-system, sans-serif;
                              color: var(--ey-black);
                              line-height: 1.8;
                          }
                          .markdown-content h1 {
                              font-size: 2.5rem;
                              font-weight: 300;
                              margin: 2rem 0 1rem;
                              color: var(--ey-black);
                              border-bottom: 2px solid var(--ey-gray-light);
                              padding-bottom: 1rem;
                          }
                          .markdown-content h2 {
                              font-size: 2rem;
                              font-weight: 400;
                              margin: 2rem 0 1rem;
                              color: var(--ey-black);
                          }
                          .markdown-content h3 {
                              font-size: 1.5rem;
                              font-weight: 500;
                              margin: 1.5rem 0 0.75rem;
                              color: var(--ey-black);
                          }
                          .markdown-content h4 {
                              font-size: 1.25rem;
                              font-weight: 600;
                              margin: 1.25rem 0 0.5rem;
                              color: var(--ey-black);
                          }
                          .markdown-content p {
                              margin-bottom: 1rem;
                          }
                          .markdown-content ul, .markdown-content ol {
                              margin: 1rem 0 1rem 2rem;
                          }
                          .markdown-content li {
                              margin-bottom: 0.5rem;
                          }
                          .markdown-content strong {
                              font-weight: 600;
                              color: var(--ey-black);
                          }
                          .markdown-content blockquote {
                              border-left: 4px solid var(--ey-yellow);
                              padding-left: 1rem;
                              margin: 1.5rem 0;
                              color: var(--ey-gray-dark);
                              font-style: italic;
                          }
                          .markdown-content code {
                              background: var(--ey-gray-light);
                              padding: 0.125rem 0.375rem;
                              border-radius: 3px;
                              font-family: monospace;
                              font-size: 0.875em;
                          }
                          .markdown-content pre {
                              background: var(--ey-gray-light);
                              padding: 1rem;
                              border-radius: 4px;
                              overflow-x: auto;
                              margin: 1rem 0;
                          }
                          .markdown-content pre code {
                              background: none;
                              padding: 0;
                          }
                          .markdown-content table {
                              width: 100%;
                              border-collapse: collapse;
                              margin: 1.5rem 0;
                          }
                          .markdown-content th {
                              background: var(--ey-gray-light);
                              padding: 0.75rem;
                              text-align: left;
                              font-weight: 600;
                              border-bottom: 2px solid var(--ey-gray-medium);
                          }
                          .markdown-content td {
                              padding: 0.75rem;
                              border-bottom: 1px solid var(--ey-gray-light);
                          }
                          .markdown-content tr:hover {
                              background: rgba(0, 0, 0, 0.02);
                          }
                          .markdown-content a {
                              color: var(--ey-blue);
                              text-decoration: none;
                              font-weight: 500;
                          }
                          .markdown-content a:hover {
                              text-decoration: underline;
                          }
                          .markdown-content hr {
                              border: none;
                              border-top: 1px solid var(--ey-gray-medium);
                              margin: 2rem 0;
                          }
                      `;
          document.head.appendChild(style);

          // Scroll to top of report
          window.scrollTo({ top: 0, behavior: "smooth" });
        } catch (error) {
          console.error("Error loading report:", error);
          document.getElementById("reportContent").innerHTML = `
                          <div style="text-align: center; padding: 3rem;">
                              <p style="color: var(--ey-red); font-weight: 600;">Failed to load report</p>
                              <p style="color: var(--ey-gray-dark); margin-top: 0.5rem;">Please try again or check your connection</p>
                          </div>
                      `;
        }
      }

      function closeReport() {
        document.getElementById("reportViewer").style.display = "none";
        document.getElementById("reportsList").style.display = "grid";
      }

      // Removed embedded reports to fix syntax error
      const embeddedReports = {};

      // Fallback function when fetch fails
      function getReportFallback(filename) {
        // Return embedded content if available
        if (embeddedReports[filename]) {
          return embeddedReports[filename];
        }

        // Otherwise return instructions
        return "Report not available in embedded viewer. Please access the markdown files directly from the project directory.";
      }
    </script>
    <script>
      // Fix data structure mismatch
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(() => {
          if (window.DASHBOARD_DATA && window.DASHBOARD_DATA.summary) {
            // Create the missing category_distribution from final_category_distribution
            if (
              !window.DASHBOARD_DATA.summary.category_distribution &&
              window.DASHBOARD_DATA.summary.final_category_distribution
            ) {
              window.DASHBOARD_DATA.summary.category_distribution =
                window.DASHBOARD_DATA.summary.final_category_distribution;
              console.log("Fixed category_distribution mapping");
            }
          }
        }, 100);
      });
    </script>

    <script>
      // Segmented Control Functionality
      window.currentSentimentFilter = "both";
      window.currentCategoryFilter = "both";

      // Function to refresh category chart based on filter
      function refreshCategoryChart() {
        if (typeof createCategoryChart === "function") {
          createCategoryChart();
        }
      }

      // Initialize chart filter event listeners
      function initializeChartFilters() {
        console.log("🔄 Initializing chart filters...");

        // Category chart filter
        const categoryFilter = document.getElementById("categoryChartFilter");
        if (categoryFilter) {
          categoryFilter.addEventListener("click", function (e) {
            if (e.target.classList.contains("segmented-option")) {
              console.log(
                "🔄 Category filter button clicked:",
                e.target.dataset.value
              );

              // Update active state
              document
                .querySelectorAll("#categoryChartFilter .segmented-option")
                .forEach((btn) => {
                  btn.classList.remove("active");
                });
              e.target.classList.add("active");

              // Update filter and refresh chart
              window.currentCategoryFilter = e.target.dataset.value;
              console.log(
                "🔄 Category filter changed to:",
                window.currentCategoryFilter
              );
              refreshCategoryChart();
            }
          });
          console.log("✅ Category chart filter initialized");
        } else {
          console.error("❌ Category chart filter element not found");
        }
      }

      // Function to get filtered iOS reviews for charts
      window.getFilteredIOSReviews = function (appFilter) {
        if (!window.DASHBOARD_DATA || !window.DASHBOARD_DATA.all_reviews) {
          console.log("❌ No DASHBOARD_DATA available");
          return [];
        }

        console.log(
          "🔍 Total reviews available:",
          window.DASHBOARD_DATA.all_reviews.length
        );

        let reviews = window.DASHBOARD_DATA.all_reviews.filter(
          (review) => review.platform && review.platform.toLowerCase() === "ios"
        );

        console.log("📱 iOS reviews found:", reviews.length);

        if (appFilter === "rogers") {
          reviews = reviews.filter(
            (review) =>
              review.app_name &&
              review.app_name.toLowerCase().includes("rogers")
          );
        } else if (appFilter === "bell") {
          reviews = reviews.filter(
            (review) =>
              review.app_name && review.app_name.toLowerCase().includes("bell")
          );
        }

        console.log(
          "✅ Returning",
          reviews.length,
          "iOS reviews for filter:",
          appFilter
        );
        return reviews;
      };
    </script>

    <script>
      // Override the showTab function from dashboard_final.js with our fixed version
      window.showTab = function (tabName) {
        // Update nav - remove all active states first
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Find and activate only the correct tab
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          const tabText = tab.textContent.trim();
          let shouldActivate = false;

          switch (tabName) {
            case "insights":
              shouldActivate = tabText === "Executive Insights";
              break;
            case "analysis":
              shouldActivate = tabText === "Reviews";
              break;
            case "report":
              shouldActivate = tabText === "Strategic Report";
              break;
            case "methodology":
              shouldActivate = tabText === "Research Methodology";
              break;
            case "reports":
              shouldActivate = tabText === "All Reports";
              break;
          }

          if (shouldActivate) {
            tab.classList.add("active");
          }
        });

        // Update content
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.remove("active");
        });
        const targetContent = document.getElementById(tabName);
        if (targetContent) {
          targetContent.classList.add("active");
        }

        // Update URL
        const url = new URL(window.location);
        url.searchParams.set("tab", tabName);
        window.history.pushState({ tab: tabName }, "", url);

        // Generate insights when insights tab is shown (from dashboard_final.js)
        if (tabName === "insights" && typeof generateInsights === "function") {
          console.log("📊 Insights tab activated, refreshing insights...");
          generateInsights();
        }
      };

      // Initialize with URL parameters
      document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const tabParam = urlParams.get("tab");
        if (tabParam) {
          // Wait for dashboard to load then switch to the requested tab
          setTimeout(() => {
            showTab(tabParam);
          }, 100);
        }
      });

      // Override navigation to use our showTab function
      window.SharedNavigation.navigateTo = function (tab) {
        showTab(tab);
      };

      // Rogers Branding Functionality
      function initializeRogersBranding() {
        console.log("🔴 Initializing Rogers branding...");

        // Add event listeners for segmented controls
        const segmentedControls = document.querySelectorAll(
          '.segmented-control input[type="radio"]'
        );
        segmentedControls.forEach((control) => {
          control.addEventListener("change", handleProviderSelection);
        });

        // Initial check for existing selections
        handleProviderSelection();
      }

      function handleProviderSelection() {
        const allCards = document.querySelectorAll(
          ".insight-card, .chart-container, .stat-card"
        );
        const chartSubtitles = document.querySelectorAll(".chart-subtitle");

        // Check for Rogers selection in any segmented control
        const rogersSelected = document.querySelector(
          '.segmented-control input[value*="rogers"]:checked, .segmented-control input[value*="Rogers"]:checked'
        );
        const bellSelected = document.querySelector(
          '.segmented-control input[value*="bell"]:checked, .segmented-control input[value*="Bell"]:checked'
        );

        console.log("🔍 Rogers selected:", !!rogersSelected);
        console.log("🔍 Bell selected:", !!bellSelected);

        if (rogersSelected) {
          applyRogersBranding(allCards, chartSubtitles);
        } else if (bellSelected) {
          applyBellBranding(allCards, chartSubtitles);
        } else {
          // Default state - remove any provider-specific branding
          removeProviderBranding(allCards, chartSubtitles);
        }
      }

      function applyRogersBranding(cards, subtitles) {
        console.log("🔴 Applying Rogers branding to", cards.length, "cards");

        cards.forEach((card) => {
          card.classList.remove("bell-branded");
          card.classList.add("rogers-branded");

          // Add rogers-selected class for enhanced styling
          card.classList.add("rogers-selected");
        });

        // Update chart subtitles
        subtitles.forEach((subtitle) => {
          if (
            subtitle.textContent.includes("analysis") ||
            subtitle.textContent.includes("data")
          ) {
            subtitle.textContent = subtitle.textContent.replace(
              /analysis|data/g,
              "Rogers-focused analysis"
            );
          }
        });

        // Update reports section if Rogers report exists
        const rogersReportCard = document.querySelector(
          '[data-report="rogers"]'
        );
        if (rogersReportCard) {
          rogersReportCard.classList.add("rogers-highlight");
        }
      }

      function applyBellBranding(cards, subtitles) {
        console.log("🔵 Applying Bell branding to", cards.length, "cards");

        cards.forEach((card) => {
          card.classList.remove("rogers-branded", "rogers-selected");
          card.classList.add("bell-branded");
        });

        // Update chart subtitles
        subtitles.forEach((subtitle) => {
          if (subtitle.textContent.includes("Rogers-focused")) {
            subtitle.textContent = subtitle.textContent.replace(
              "Rogers-focused",
              "Bell-focused"
            );
          } else if (
            subtitle.textContent.includes("analysis") ||
            subtitle.textContent.includes("data")
          ) {
            subtitle.textContent = subtitle.textContent.replace(
              /analysis|data/g,
              "Bell-focused analysis"
            );
          }
        });
      }

      function removeProviderBranding(cards, subtitles) {
        console.log("⚪ Removing provider branding");

        cards.forEach((card) => {
          card.classList.remove(
            "rogers-branded",
            "rogers-selected",
            "bell-branded",
            "rogers-highlight"
          );
        });

        // Reset chart subtitles
        subtitles.forEach((subtitle) => {
          subtitle.textContent = subtitle.textContent
            .replace("Rogers-focused analysis", "analysis")
            .replace("Bell-focused analysis", "analysis");
        });
      }

      // Initialize Rogers branding when DOM is ready
      document.addEventListener("DOMContentLoaded", function () {
        console.log("📱 Dashboard loaded, initializing Rogers branding...");
        setTimeout(initializeRogersBranding, 500); // Small delay to ensure all elements are rendered

        // Initialize the dashboard data
        console.log("🔄 Initializing dashboard data...");
        setTimeout(initializeStandaloneMode, 100); // Initialize after scripts load
      });
    </script>

    <!-- Footer -->
    <footer
      style="
        background: var(--ey-white);
        border-top: 1px solid var(--ey-gray-medium);
        padding: 2rem;
        text-align: center;
        margin-top: 4rem;
      "
    >
      <p style="color: var(--ey-gray-dark); font-size: 0.875rem; margin: 0">
        © 2025 EY Canada. All rights reserved.
      </p>
      <p
        style="
          color: var(--ey-gray-dark);
          font-size: 0.875rem;
          margin: 0.5rem 0 0 0;
        "
      >
        <a
          href="data_accuracy_report.html"
          style="color: var(--ey-blue); text-decoration: none; font-weight: 500"
          >Data Accuracy Report</a
        >
      </p>
    </footer>
  </body>
</html>
